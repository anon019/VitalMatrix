<!--pages/ai/ai.wxml-->
<view class="ai-container">
  <!-- èƒŒæ™¯è£…é¥°å±‚ -->
  <view class="bg-layer">
    <view class="bg-orb orb-1"></view>
    <view class="bg-orb orb-2"></view>
    <view class="bg-orb orb-3"></view>
    <view class="constellation-dots">
      <view class="dot dot-1"></view>
      <view class="dot dot-2"></view>
      <view class="dot dot-3"></view>
      <view class="dot dot-4"></view>
      <view class="dot dot-5"></view>
    </view>
  </view>

  <!-- è‹±é›„åŒºå¤´éƒ¨ -->
  <view class="hero-section">
    <!-- AIæ ¸å¿ƒè„‰å†²åŠ¨ç”» -->
    <view class="ai-core">
      <view class="pulse-ring ring-1"></view>
      <view class="pulse-ring ring-2"></view>
      <view class="pulse-ring ring-3"></view>
      <view class="core-center">
        <text class="core-icon">ğŸ§ </text>
      </view>
    </view>

    <view class="hero-text">
      <text class="hero-title">AI å¥åº·åŠ©ç†</text>
      <text class="hero-subtitle">{{todayDate}}</text>
    </view>

    <!-- æ¨¡å‹ä¿¡æ¯å¾½ç«  -->
    <view class="model-badge" wx:if="{{aiModel}}">
      <view class="badge-glow"></view>
      <text class="badge-text">{{aiModel}}</text>
      <text class="badge-time">{{generatedTime}}</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-pulse">
      <view class="loading-dot"></view>
      <view class="loading-dot"></view>
      <view class="loading-dot"></view>
    </view>
    <text class="loading-text">AI æ­£åœ¨åˆ†ææ‚¨çš„å¥åº·æ•°æ®...</text>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content-area" wx:else>
    <!-- æ•°æ®æ—¥æœŸæç¤º -->
    <view class="date-notice glass-card" wx:if="{{!isDataToday}}">
      <view class="notice-icon-wrap">
        <text class="notice-icon">ğŸ“…</text>
      </view>
      <text class="notice-text">æ•°æ®æ¥è‡ª {{dataDate}}ï¼Œä»Šæ—¥æš‚æ— æ›´æ–°</text>
    </view>

    <!-- ä¸€å¥è¯æ€»ç»“ - çªå‡ºæ˜¾ç¤º -->
    <view class="summary-hero glass-card card-animate" wx:if="{{summary}}" style="--delay: 0.1s">
      <view class="summary-glow"></view>
      <view class="summary-icon-wrap">
        <text class="summary-icon">âœ¨</text>
      </view>
      <text class="summary-text">{{summary}}</text>
    </view>

    <!-- æ•°æ®å›é¡¾ -->
    <view class="insight-card glass-card review-theme card-animate" wx:if="{{yesterdayReview && yesterdayReview.items && yesterdayReview.items.length > 0}}" style="--delay: 0.2s">
      <view class="card-header">
        <view class="card-icon-wrap review-icon">
          <text class="card-emoji">ğŸ“Š</text>
        </view>
        <view class="card-title-group">
          <text class="card-title">æ•°æ®å›é¡¾</text>
          <text class="card-subtitle">Data Review</text>
        </view>
      </view>

      <view class="card-content">
        <view class="insight-item" wx:for="{{yesterdayReview.items}}" wx:key="index" style="--item-delay: {{index * 0.05}}s">
          <view class="insight-marker review-marker"></view>
          <text class="insight-text">{{item}}</text>
        </view>
      </view>
    </view>

    <!-- ä»Šæ—¥ç»¼åˆå»ºè®® -->
    <view class="insight-card glass-card advice-theme card-animate" wx:if="{{todayRecommendation && todayRecommendation.items && todayRecommendation.items.length > 0}}" style="--delay: 0.3s">
      <view class="card-header">
        <view class="card-icon-wrap advice-icon">
          <text class="card-emoji">ğŸ’¡</text>
        </view>
        <view class="card-title-group">
          <text class="card-title">ä»Šæ—¥ç»¼åˆå»ºè®®</text>
          <text class="card-subtitle">Today's Recommendations</text>
        </view>
      </view>

      <view class="card-content">
        <view class="advice-item" wx:for="{{todayRecommendation.items}}" wx:key="index" style="--item-delay: {{index * 0.05}}s">
          <view class="advice-number">{{index + 1}}</view>
          <view class="advice-body">
            <text class="advice-label" wx:if="{{item.label}}">{{item.label}}</text>
            <text class="advice-text">{{item.text || item}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- å¥åº·çŸ¥è¯†ç‚¹ -->
    <view class="insight-card glass-card knowledge-theme card-animate" wx:if="{{healthEducation && healthEducation.sections && healthEducation.sections.length > 0}}" style="--delay: 0.4s">
      <view class="card-header">
        <view class="card-icon-wrap knowledge-icon">
          <text class="card-emoji">ğŸ“š</text>
        </view>
        <view class="card-title-group">
          <text class="card-title">å¥åº·çŸ¥è¯†ç‚¹</text>
          <text class="card-subtitle">Health Education</text>
        </view>
      </view>

      <view class="card-content">
        <view class="knowledge-section" wx:for="{{healthEducation.sections}}" wx:for-item="section" wx:key="index">
          <view class="section-header">
            <view class="section-dot"></view>
            <text class="section-title">{{section.subtitle}}</text>
          </view>
          <view class="knowledge-list">
            <view class="knowledge-item" wx:for="{{section.items}}" wx:for-item="point" wx:key="index">
              <text class="knowledge-label">{{point.label}}</text>
              <text class="knowledge-text">{{point.content}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state glass-card" wx:if="{{!yesterdayReview && !todayRecommendation && !healthEducation}}">
      <view class="empty-animation">
        <view class="empty-orbit">
          <view class="orbit-dot"></view>
        </view>
        <text class="empty-icon">ğŸ¤–</text>
      </view>
      <text class="empty-title">æš‚æ— AIå»ºè®®</text>
      <text class="empty-desc">åç«¯AIæœåŠ¡å‡†å¤‡ä¸­...</text>
      <view class="refresh-btn" bindtap="loadData">
        <text class="btn-text">åˆ·æ–°</text>
        <view class="btn-shine"></view>
      </view>
    </view>

    <!-- åº•éƒ¨ç•™ç™½ -->
    <view class="bottom-spacer"></view>
  </view>
</view>
