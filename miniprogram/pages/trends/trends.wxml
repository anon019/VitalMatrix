<!--pages/trends/trends.wxml-->
<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ - æ–°è‹±é›„åŒºè®¾è®¡ -->
  <view class="trends-hero">
    <!-- è£…é¥°æ€§èƒŒæ™¯å…ƒç´  -->
    <view class="hero-decoration">
      <view class="deco-circle circle-1"></view>
      <view class="deco-circle circle-2"></view>
      <view class="deco-line line-1"></view>
      <view class="deco-line line-2"></view>
    </view>

    <view class="hero-content">
      <view class="hero-title-row">
        <text class="hero-title">æ•°æ®è¶‹åŠ¿</text>
        <text class="hero-badge">7å¤©</text>
      </view>
      <text class="hero-date">{{dateRange}}</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-spinner">
      <view class="spinner-ring"></view>
      <view class="spinner-ring"></view>
      <view class="spinner-ring"></view>
    </view>
    <text class="loading-text">æ•°æ®åŠ è½½ä¸­...</text>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content-area" wx:else>
    <!-- ========== Polar è®­ç»ƒæ•°æ® ========== -->
    <view class="section-group polar-section">
      <view class="section-header">
        <view class="section-icon polar-icon">
          <text class="section-emoji">ğŸ’ª</text>
        </view>
        <view class="section-title-group">
          <text class="section-title">Polar è®­ç»ƒæ•°æ®</text>
          <text class="section-subtitle">Training Metrics</text>
        </view>
      </view>

    <!-- è„‚è‚ªç‡ƒçƒ§ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.1s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ”¥</text>
          <text class="card-title">è„‚è‚ªç‡ƒçƒ§</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{fatBurnData.length > 0}}">
        <!-- å‡å€¼è™šçº¿ -->
        <view class="avg-line" style="top: calc(40rpx + (100 - {{fatBurnAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{fatBurnLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{fatBurnAvgPercent}}) * 2.2rpx)">{{avgFatBurn}}g</view>
        <!-- æŸ±çŠ¶å›¾ -->
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{fatBurnData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar orange {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- Zone2æ—¶é•¿ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.15s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸƒ</text>
          <text class="card-title">Zone2æ—¶é•¿</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{zone2Data.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{zone2AvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{zone2LabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{zone2AvgPercent}}) * 2.2rpx)">{{avgZone2}}min</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{zone2Data}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar blue {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- è®­ç»ƒå¡è·¯é‡Œ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.2s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">âš¡</text>
          <text class="card-title">è®­ç»ƒå¡è·¯é‡Œ</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{caloriesData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{caloriesAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{caloriesLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{caloriesAvgPercent}}) * 2.2rpx)">{{avgCalories}}kcal</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{caloriesData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar yellow {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>
    </view><!-- /polar-section -->

    <!-- ========== Oura ç¡çœ æ•°æ® ========== -->
    <view class="section-group oura-sleep-section">
      <view class="section-header">
        <view class="section-icon oura-icon">
          <text class="section-emoji">ğŸ˜´</text>
        </view>
        <view class="section-title-group">
          <text class="section-title">Oura ç¡çœ æ•°æ®</text>
          <text class="section-subtitle">Sleep Metrics</text>
        </view>
      </view>

    <!-- ç¡çœ è¯„åˆ†ï¼ˆæ”¯æŒä¸»ç¡çœ +åˆç¡å åŠ æ˜¾ç¤ºï¼‰ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.25s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ˜´</text>
          <text class="card-title">ç¡çœ è¯„åˆ†</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{sleepScoreData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{sleepScoreAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{sleepScoreLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{sleepScoreAvgPercent}}) * 2.2rpx)">{{avgSleepScore}}</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{sleepScoreData}}" wx:key="date">
            <view class="bar-wrapper">
              <!-- å åŠ æŸ±çŠ¶å›¾ï¼šåŸºç¡€åˆ†+åˆç¡åŠ åˆ† -->
              <view class="stacked-bar {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <!-- åˆç¡åŠ åˆ†éƒ¨åˆ† -->
                <view class="bar-boost sleep-score-boost" wx:if="{{item.hasBoost}}" style="height: {{item.boostPercent / item.percent * 100}}%">
                  <text class="boost-value">+{{item.boostValue}}</text>
                </view>
                <!-- ä¸»ç¡çœ åŸºç¡€éƒ¨åˆ† -->
                <view class="bar-base sleep-blue" style="height: {{item.basePercent / item.percent * 100}}%">
                  <text class="base-value">{{item.baseValue}}</text>
                </view>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- ç¡çœ æ€»æ—¶é•¿ï¼ˆæ”¯æŒä¸»ç¡çœ +åˆç¡å åŠ æ˜¾ç¤ºï¼‰ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.3s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ›ï¸</text>
          <text class="card-title">ç¡çœ æ€»æ—¶é•¿</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{totalSleepData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{totalSleepAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{totalSleepLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{totalSleepAvgPercent}}) * 2.2rpx)">{{avgTotalSleep}}h</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{totalSleepData}}" wx:key="date">
            <view class="bar-wrapper">
              <!-- å åŠ æŸ±çŠ¶å›¾ï¼šä¸»ç¡çœ æ—¶é•¿+åˆç¡æ—¶é•¿ -->
              <view class="stacked-bar {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <!-- åˆç¡æ—¶é•¿éƒ¨åˆ† -->
                <view class="bar-boost sleep-duration-boost" wx:if="{{item.hasBoost}}" style="height: {{item.boostPercent / item.percent * 100}}%">
                  <text class="boost-value">+{{item.boostValue}}</text>
                </view>
                <!-- ä¸»ç¡çœ æ—¶é•¿éƒ¨åˆ† -->
                <view class="bar-base sleep-light" style="height: {{item.basePercent / item.percent * 100}}%">
                  <text class="base-value">{{item.baseValue}}</text>
                </view>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- æ·±ç¡çœ ï¼ˆæ”¯æŒä¸»ç¡çœ +åˆç¡å åŠ æ˜¾ç¤ºï¼‰ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.35s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸŒ™</text>
          <text class="card-title">æ·±ç¡çœ </text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{deepSleepData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{deepSleepAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{deepSleepLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{deepSleepAvgPercent}}) * 2.2rpx)">{{avgDeepSleep}}min</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{deepSleepData}}" wx:key="date">
            <view class="bar-wrapper">
              <!-- å åŠ æŸ±çŠ¶å›¾ï¼šä¸»ç¡çœ æ·±ç¡+åˆç¡æ·±ç¡ -->
              <view class="stacked-bar {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <!-- åˆç¡æ·±ç¡éƒ¨åˆ† -->
                <view class="bar-boost deep-sleep-boost" wx:if="{{item.hasBoost}}" style="height: {{item.boostPercent / item.percent * 100}}%">
                  <text class="boost-value">+{{item.boostValue}}</text>
                </view>
                <!-- ä¸»ç¡çœ æ·±ç¡éƒ¨åˆ† -->
                <view class="bar-base deep-blue" style="height: {{item.basePercent / item.percent * 100}}%">
                  <text class="base-value">{{item.baseValue}}</text>
                </view>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- REMç¡çœ ï¼ˆæ”¯æŒä¸»ç¡çœ +åˆç¡å åŠ æ˜¾ç¤ºï¼‰ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.4s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ’¤</text>
          <text class="card-title">REMç¡çœ </text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{remSleepData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{remSleepAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{remSleepLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{remSleepAvgPercent}}) * 2.2rpx)">{{avgRemSleep}}min</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{remSleepData}}" wx:key="date">
            <view class="bar-wrapper">
              <!-- å åŠ æŸ±çŠ¶å›¾ï¼šä¸»ç¡çœ REM+åˆç¡REM -->
              <view class="stacked-bar {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <!-- åˆç¡REMéƒ¨åˆ† -->
                <view class="bar-boost rem-sleep-boost" wx:if="{{item.hasBoost}}" style="height: {{item.boostPercent / item.percent * 100}}%">
                  <text class="boost-value">+{{item.boostValue}}</text>
                </view>
                <!-- ä¸»ç¡çœ REMéƒ¨åˆ† -->
                <view class="bar-base violet" style="height: {{item.basePercent / item.percent * 100}}%">
                  <text class="base-value">{{item.baseValue}}</text>
                </view>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>
    <!-- HRV å¿ƒç‡å˜å¼‚æ€§ - æ ¸å¿ƒæ¢å¤æŒ‡æ ‡ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.42s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ’—</text>
          <text class="card-title">HRV å¿ƒç‡å˜å¼‚æ€§</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{hrvData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{hrvAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{hrvLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{hrvAvgPercent}}) * 2.2rpx)">{{avgHrv}}ms</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{hrvData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar hrv-magenta {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- é™æ¯å¿ƒç‡ RHR -->
    <view class="card trend-card card-animate" style="--card-delay: 0.44s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">â¤ï¸</text>
          <text class="card-title">é™æ¯å¿ƒç‡</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{rhrData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{rhrAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{rhrLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{rhrAvgPercent}}) * 2.2rpx)">{{avgRhr}}bpm</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{rhrData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar red {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- è¡€æ°§ SpO2 -->
    <view class="card trend-card card-animate" style="--card-delay: 0.46s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ«</text>
          <text class="card-title">è¡€æ°§é¥±å’Œåº¦</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{spo2Data.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{spo2AvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{spo2LabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{spo2AvgPercent}}) * 2.2rpx)">{{avgSpo2}}%</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{spo2Data}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar red {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- å‘¼å¸é¢‘ç‡ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.48s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸŒ¬ï¸</text>
          <text class="card-title">å‘¼å¸é¢‘ç‡</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{breathData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{breathAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{breathLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{breathAvgPercent}}) * 2.2rpx)">{{avgBreath}}/min</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{breathData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar breath-cyan {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- å¿ƒç‡æ¢å¤ä½ç½®ï¼ˆæœ€ä½å¿ƒç‡å‡ºç°çš„ç¡çœ è¿›åº¦ç™¾åˆ†æ¯”ï¼Œè¶Šä½è¶Šå¥½ï¼‰ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.5s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ’“</text>
          <text class="card-title">å¿ƒç‡æ¢å¤ä½ç½®</text>
        </view>
        <view class="card-hint">è¶Šä½è¶Šå¥½ï¼Œâ‰¤50%ä¸ºç†æƒ³</view>
      </view>
      <view class="chart-container" wx:if="{{hrPositionData.length > 0}}">
        <!-- 50%å‚è€ƒçº¿ï¼ˆç†æƒ³/æ¬¡ä¼˜åˆ†ç•Œçº¿ï¼‰ -->
        <view class="reference-line" style="top: calc(40rpx + 50 * 2.2rpx)"></view>
        <view class="avg-line" style="top: calc(40rpx + (100 - {{hrPositionAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{hrPositionLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{hrPositionAvgPercent}}) * 2.2rpx)">{{avgHrPosition}}%</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{hrPositionData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar {{item.colorClass}} {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>
    </view><!-- /oura-sleep-section -->

    <!-- ========== Oura å‡†å¤‡åº¦/æ´»åŠ¨æ•°æ® ========== -->
    <view class="section-group oura-activity-section">
      <view class="section-header">
        <view class="section-icon oura-icon">
          <text class="section-emoji">ğŸ”‹</text>
        </view>
        <view class="section-title-group">
          <text class="section-title">Oura æ´»åŠ¨æ•°æ®</text>
          <text class="section-subtitle">Activity Metrics</text>
        </view>
      </view>

    <!-- å‡†å¤‡åº¦è¯„åˆ†ï¼ˆæ”¯æŒåŸºç¡€åˆ†+åˆç¡åŠ åˆ†å åŠ æ˜¾ç¤ºï¼‰ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.45s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ”‹</text>
          <text class="card-title">å‡†å¤‡åº¦è¯„åˆ†</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{readinessData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{readinessAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{readinessLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{readinessAvgPercent}}) * 2.2rpx)">{{avgReadiness}}</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{readinessData}}" wx:key="date">
            <view class="bar-wrapper">
              <!-- å åŠ æŸ±çŠ¶å›¾ï¼šåŸºç¡€åˆ†+åˆç¡åŠ åˆ† -->
              <view class="stacked-bar {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <!-- åˆç¡åŠ åˆ†éƒ¨åˆ† -->
                <view class="bar-boost readiness-boost" wx:if="{{item.hasBoost}}" style="height: {{item.boostPercent / item.percent * 100}}%">
                  <text class="boost-value">+{{item.boostValue}}</text>
                </view>
                <!-- åŸºç¡€å‡†å¤‡åº¦éƒ¨åˆ† -->
                <view class="bar-base amber" style="height: {{item.basePercent / item.percent * 100}}%">
                  <text class="base-value">{{item.baseValue}}</text>
                </view>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- æ´»åŠ¨è¯„åˆ† -->
    <view class="card trend-card card-animate" style="--card-delay: 0.5s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ¯</text>
          <text class="card-title">æ´»åŠ¨è¯„åˆ†</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{activityScoreData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{activityScoreAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{activityScoreLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{activityScoreAvgPercent}}) * 2.2rpx)">{{avgActivityScore}}</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{activityScoreData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar teal {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- æ­¥æ•° -->
    <view class="card trend-card card-animate" style="--card-delay: 0.55s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ‘Ÿ</text>
          <text class="card-title">æ­¥æ•°</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{stepsData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{stepsAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{stepsLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{stepsAvgPercent}}) * 2.2rpx)">{{avgSteps}}æ­¥</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{stepsData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar blue {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- ä¹…åæ—¶é—´ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.6s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸª‘</text>
          <text class="card-title">ä¹…åæ—¶é—´</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{sedentaryData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{sedentaryAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{sedentaryLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{sedentaryAvgPercent}}) * 2.2rpx)">{{avgSedentary}}min</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{sedentaryData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar gray {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>
    </view><!-- /oura-activity-section -->

    <!-- ========== Oura å‹åŠ›æ•°æ® ========== -->
    <view class="section-group oura-stress-section">
      <view class="section-header">
        <view class="section-icon stress-icon">
          <text class="section-emoji">ğŸ§˜</text>
        </view>
        <view class="section-title-group">
          <text class="section-title">Oura å‹åŠ›ä¸æ¢å¤</text>
          <text class="section-subtitle">Stress & Recovery</text>
        </view>
      </view>

    <!-- å‹åŠ›æ—¶é—´ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.65s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ˜°</text>
          <text class="card-title">å‹åŠ›æ—¶é—´</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{stressedData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{stressedAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{stressedLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{stressedAvgPercent}}) * 2.2rpx)">{{avgStressed}}min</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{stressedData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar stress-orange {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>

    <!-- æ¢å¤æ—¶é—´ -->
    <view class="card trend-card card-animate" style="--card-delay: 0.7s">
      <view class="card-header">
        <view class="card-title-row">
          <text class="card-icon">ğŸ§˜</text>
          <text class="card-title">æ¢å¤æ—¶é—´</text>
        </view>
      </view>
      <view class="chart-container" wx:if="{{restoredData.length > 0}}">
        <view class="avg-line" style="top: calc(40rpx + (100 - {{restoredAvgPercent}}) * 2.2rpx)"></view>
        <view class="avg-value-label {{restoredLabelBelow ? 'label-below' : 'label-above'}}" style="top: calc(40rpx + (100 - {{restoredAvgPercent}}) * 2.2rpx)">{{avgRestored}}min</view>
        <view class="chart-bars">
          <view class="bar-item avg-item">
            <view class="bar-wrapper"></view>
            <text class="bar-label">å¹³å‡</text>
          </view>
          <view class="bar-item" wx:for="{{restoredData}}" wx:key="date">
            <view class="bar-wrapper">
              <view class="bar green {{item.isEmpty ? 'empty-bar' : ''}}" style="height: {{item.isEmpty ? 'auto' : item.percent + '%'}}">
                <text class="bar-value">{{item.value}}</text>
              </view>
            </view>
            <text class="bar-label">{{item.dayLabel}}</text>
          </view>
        </view>
      </view>
      <view class="empty" wx:else><text>æš‚æ— æ•°æ®</text></view>
    </view>
    </view><!-- /oura-stress-section -->

    <!-- åº•éƒ¨ç•™ç™½ -->
    <view class="bottom-spacer"></view>
  </view>
</view>
